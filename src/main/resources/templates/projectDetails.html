<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>프로젝트 상세</title>
    <style>
        .container {max-width: 12000px; margin: 20px auto; padding: 20px}
        .project-header{
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }

        .project-header h1 {margin: 0;}
        .project-status {display: inline-block; padding: 5px 10px; border-radius: 5px; font-weight: bold;}

        .admin-controls{
            background-color: #fff8e1;
            border: 1px solid #ffecb3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
        }
        .btn{
            padding: 8px 12px;
            text-decoration: none;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            margin-right: 10px;
        }
        .btn-primary{background-color: #007bff; color: white;}
        .btn-secondary{background-color: #6c757d; color: white;}
        .btn-warning{background-color: #ffc107; color: #333;}
        .main-layout{display: flex; gap:20px;}
        .task-column {flex: 3; background-color: white; padding: 20px; border-radius: 8px; border: 1px solid #ddd}
        .box {background-color: white; padding:20px; border-radius: 8px; border: 1px solid #ddd}
        .box ul {list-style: none; padding: 0; margin:0;}
        .box li {padding: 8px 0; border-bottom: 1px solid #f0f0f0;}
        .box li:last-child {border-bottom: none;}

        .sidebar-column{flex:1 ; display: flex; flex-direction: column; gap: 20px;}

        .task-header, .box-header{
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 10px;
            margin-bottom: 15px;
        }

        .task-header h3, .box-header h3 {margin: 0}


        .task-item { display: flex; justify-content: space-between; align-items: center; }
        .task-item a { text-decoration: none; color: #0056b3; font-weight: bold; }

        .member-item { display: flex; justify-content: space-between; align-items: center; }
        .admin-tag { background-color: #f0ad4e; color: white; font-size: 0.8em; padding: 2px 5px; border-radius: 3px; }
    </style>
</head>
<body>


<div class="container" th:object="${projectDetails}">
    <div class="project-header">
        <div>
            <h1 th:text="*{project.name}">프로젝트 이름 </h1>
            <span th:text="*{project.status}">프로젝트 상태</span>
        </div>
        <a th:href="@{/}" class="btn btn-secondary">대시보드</a>
    </div>

    <div th:if="${isAdmin}" class="admin-controls">
        <h3>관리자 메뉴</h3>
        <a th:href="@{/projects/{id}/edit(id=*{project.id})}" class="btn btn-warning">프로젝트 설정</a>
        <a th:href="@{/projects/{id}/members(id=*{project.id})}" class="btn btn-secondary">멤버 설정</a>
    </div>

    <div class="main-layout">
        <div class="task-column">
            <div class="task-header">
                <h3>업무 (Tasks)</h3>
                <a th:href="@{/projects/{id}/tasks(id=*{project.id})}" class="btn btn-primary">업무 추가</a>
            </div>
            <div th:if="*{tasks.isEmpty()}">
                <p>등록된 업무가 없습니다.</p>
            </div>
            <div class="task-item">
                <ul th:unless="*{tasks.isEmpty()}">
                    <li th:each="task : *{tasks}">
                        <a th:href="@{/projects/{id}/tasks/{taskId}(id=*{project.id}, taskId=*{task.id})}"
                           th:text="${task.title}">
                            업무 제목
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="sidebar-column">
            <div class="box">
                <div class="box-header">
                    <h3>멤버</h3>
                </div>
                <ul th:unless="*{members.isEmpty()}">
                    <li th:each="member: *{members}">
                        <span th:text = "${member.username}">멤버 이름</span>
                        <span th:if="${member.username.equals(project.adminUserId)}" class="admin-tag">Admin</span>
                    </li>
                </ul>
            </div>
            <div class="box">
                <div class="box-header">
                    <h3>태그</h3>
                    <a th:href="@{/projects/{id}/tags(id=*{project.id})}" class="btn btn-primary">태그 추가</a>
                </div>

                <div th:if="*{tags.isEmpty()}"> <p>태그가 없습니다.</p> </div>
                <ul th:unless="*{tags.isEmpty()}">
                    <li th:each="tag: *{tags}">
                        <span th:text="${tag.name}">태그 이름</span>
                    </li>
                </ul>
            </div>

            <div class="box">
                <div class="box-header">
                    <h3>마일스톤</h3>
                    <a th:href="@{/projects/{id}/milestones(id=*{project.id})}" class="btn btn-secondary">마일스톤 생성</a>
                </div>
                <div th:if="*{mileStone==null}">
                    <p>마일스톤이 없습니다.</p>
                </div>
                <div th:unless="*{mileStone!=null}">
                    <p th:text="@{mileStone}"> 마일스톤</p>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>